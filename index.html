<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trade Feed</title>
  <!-- Font Awesome for the share icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <!-- Binance PLEX webfont -->
  <link href="https://db.onlinewebfonts.com/c/d05c19ccecf7003d248c60ffd6b5e8f7?family=Binance+PLEX" rel="stylesheet" />
  <style>
    /* —— Adjust card spacing —— */
    .feed { display: flex; flex-direction: column; gap: 8px; }
    .trade-panel {
      margin-bottom: 0;
      background: var(--panel-bg);
      padding: 20px;
      border-radius: 8px;
      transition: transform .5s ease;
    }
    :root {
      --panel-bg: #1e2127;
      --secondary-bg: #32383e;
      --btn-bg: #2f3339;
      --text-primary: #ffffff;
      --text-secondary: #7c828a;
      --text-green: #3acf87;
      --text-red:   #e04b4a;
    }
    body {
      background: var(--panel-bg);
      font-family: "Binance PLEX", Arial, sans-serif;
      color: var(--text-primary);
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      height: 100vh;
    }
    .feed {
      width: 480px;
      height: 100vh;
      overflow-y: auto;
      padding: 20px 0;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .feed::-webkit-scrollbar { display: none; }
    .header { display: flex; align-items: center; margin-bottom: 20px; }
    .icon-buy {
      background: var(--text-green);
      color: #fff;
      width: 20px; height: 20px;
      display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: bold;
      margin-right: 8px;
    }
    .symbol { font-size: 16px; font-weight: 500; margin-right: 10px; }
    .tag {
      background: var(--secondary-bg);
      color: var(--text-secondary);
      font-size: 10px;
      padding: 1px 4px; margin-right: 6px;
      text-transform: uppercase;
    }
    .exclamations { color: var(--text-green); font-size: 18px; font-weight: bold; margin-left: 10px; }
    .share { margin-left: auto; color: var(--text-secondary); font-size: 18px; }
    .content { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px; }
    .column { display: flex; flex-direction: column; }
    .column.center { align-items: flex-start; text-align: left; }
    .column.right { text-align: right; }
    .stat { margin-bottom: 14px; }
    .label {
      font-size: 14px; color: var(--text-secondary);
      border-bottom: 1px dotted var(--text-secondary);
      padding-bottom: 3px; display: inline-block;
    }
    .value {
      font-size: 14px; font-weight: 400;
      transition: all .3s ease;
    }
    .value.green, .value.percent.green {
      color: var(--text-green);
      font-size: 20px; font-weight: bold;
    }
    .value.red, .value.percent.red {
      color: var(--text-red);
      font-size: 20px; font-weight: bold;
    }
    .column.right .stat:nth-child(2) .value.green,
    .column.right .stat:nth-child(2) .value.red {
      font-size: 14px; font-weight: 400;
    }
    .actions { display: flex; justify-content: space-between; }
    .btn {
      flex: 1; background: var(--btn-bg); color: #fff;
      border: none; border-radius: 4px;
      padding: 10px 0; font-size: 14px;
      cursor: pointer; margin: 0 6px;
      transition: background .3s;
    }
    .btn:first-child { margin-left: 0; }
    .btn:last-child  { margin-right: 0; }
    .btn:hover { background: var(--secondary-bg); }
  </style>
</head>
<body>
  <div class="feed"></div>

  <script>
    // CONFIG
    const symbols       = [
      'BTCUSDT','ETHUSDT','BNBUSDT','ADAUSDT','SOLUSDT',
      'XRPUSDT','DOTUSDT','LTCUSDT','LINKUSDT','DOGEUSDT',
      'UNIUSDT','BCHUSDT','XLMUSDT','ATOMUSDT','MATICUSDT',
      'AVAXUSDT','TRXUSDT','EOSUSDT','NEARUSDT','FILUSDT'
    ];
    const sizeCoins      = 10;
    const leverage       = 50;
    const updateInterval = 2000;    // 2 seconds
    const maxDeltaPct    = 1;       // +/-1% per update
    const maxPct         = 2000;    // clamp ROI between -2000% and +2000%
    const extraTrades    = 50;      // add 50 more

    function pickLosers(count, total) {
      const losers = [];
      while (losers.length < count) {
        const idx = Math.floor(Math.random() * total);
        if ([idx, idx-1, idx+1].some(x=>losers.includes(x))) continue;
        losers.push(idx);
      }
      return losers;
    }

    const totalCount = symbols.length + extraTrades;
    const loseIdxs   = pickLosers(2 + Math.floor(Math.random()*2), totalCount);
    const trades     = [];
    const feedDiv    = document.querySelector('.feed');

    // initialize all trades
    for (let i = 0; i < totalCount; i++) {
      const sym       = symbols[i % symbols.length];
      const isLoss    = loseIdxs.includes(i);
      const entryPrice = 100 + Math.random()*49000;
      const notional   = sizeCoins * entryPrice;
      const margin     = notional / leverage;
      let roiPct       = (isLoss ? -1 : 1) * (1 + Math.random() * (maxPct - 1));
      let profitVal    = margin * roiPct / 100;
      let markPrice    = entryPrice + profitVal/sizeCoins;
      let liqPrice     = entryPrice * (1 - 1/leverage);

      const panel = document.createElement('div');
      panel.className = 'trade-panel';
      panel.innerHTML = `
        <div class="header">
          <span class="icon-buy">B</span>
          <span class="symbol">${sym}</span>
          <span class="tag">Perp</span>
          <span class="tag">Cross ${leverage}X</span>
          <span class="exclamations">!!!</span>
          <i class="fas fa-share-alt share"></i>
        </div>
        <div class="content">
          <div class="column">
            <div class="stat"><div class="label">PNL (USDT)</div>
              <div class="value ${profitVal<0?'red':'green'}">${profitVal.toFixed(2)}</div>
            </div>
            <div class="stat"><div class="label">Size (USDT)</div>
              <div class="value">${notional.toFixed(2)}</div>
            </div>
            <div class="stat"><div class="label">Entry Price (USDT)</div>
              <div class="value">${entryPrice.toFixed(2)}</div>
            </div>
          </div>
          <div class="column center">
            <div class="stat"><div class="label">Margin (USDT)</div>
              <div class="value">${margin.toFixed(2)}</div>
            </div>
            <div class="stat"><div class="label">Mark Price (USDT)</div>
              <div class="value">${markPrice.toFixed(2)}</div>
            </div>
          </div>
          <div class="column right">
            <div class="stat"><div class="label">ROI</div>
              <div class="value percent ${profitVal<0?'red':'green'}">
                ${(profitVal>=0?'+':'') + roiPct.toFixed(2)}%
              </div>
            </div>
            <div class="stat"><div class="label">Margin Ratio</div>
              <div class="value">${(profitVal/margin).toFixed(4)}</div>
            </div>
            <div class="stat"><div class="label">Liq. Price (USDT)</div>
              <div class="value">${liqPrice.toFixed(2)}</div>
            </div>
          </div>
        </div>
        <div class="actions">
          <button class="btn">Leverage</button>
          <button class="btn">TP/SL</button>
          <button class="btn">Close</button>
          <button class="btn">Reverse</button>
        </div>`;
      feedDiv.appendChild(panel);

      trades.push({ panel, entryPrice, notional, margin, leverage, roiPct });
    }

    // smooth, slow updates
    setInterval(() => {
      trades.forEach(t => {
        t.roiPct += (Math.random()*2 - 1) * maxDeltaPct;
        t.roiPct = Math.max(-maxPct, Math.min(maxPct, t.roiPct));

        const profitVal = t.margin * t.roiPct / 100;
        const markPrice = t.entryPrice + profitVal/sizeCoins;
        const liqPrice  = t.entryPrice * (1 - 1/t.leverage);

        const vals = t.panel.querySelectorAll('.value');
        vals[0].textContent = profitVal.toFixed(2);
        vals[0].classList.toggle('green', profitVal >= 0);
        vals[0].classList.toggle('red',   profitVal < 0);

        vals[4].textContent = markPrice.toFixed(2);

        const roiEl = vals[5];
        roiEl.textContent = (profitVal>=0?'+':'') + t.roiPct.toFixed(2) + '%';
        roiEl.classList.toggle('green', t.roiPct >= 0);
        roiEl.classList.toggle('red',   t.roiPct < 0);

        vals[6].textContent = (profitVal/t.margin).toFixed(4);
        vals[7].textContent = liqPrice.toFixed(2);
      });
    }, updateInterval);
  </script>
</body>
</html>
